name: TRIPS-API-GO-CD

on:
#  workflow_run:
#    workflows:
#      - "POI-API-CI"
#    types:
#      - "completed"
  push:
    branches: [ main ]
    paths:
      - ".github/workflows/trips-api-go-cd.yml"
  pull_request:
    branches: [ main ]
    paths:
      - ".github/workflows/trips-api-go-cd.yml"

jobs:  
  deploy:
#    if: ${{ github.event.workflow_run.conclusion == 'success' }}  
    uses: marceloes/openhack-devops-team/.github/workflows/deploy-container-webapp.yml@main
    with:
      filepath: "apis/trips"
      imagename: "devopsoh/api-trips"
      acrname: "openhack4ue1whv5acr"
      webappname: "openhack4ue1whv5trips"
      slotname: staging
    secrets:
      azurecreds: ${{ secrets.AZURE_CREDS }}

